# 2024-sba

[![built with garnix](https://img.shields.io/endpoint.svg?url=https%3A%2F%2Fgarnix.io%2Fapi%2Fbadges%2Fsoopyc%2F2024-sba%3Fbranch%3Dmain)](https://garnix.io)
[![built with nix](https://img.shields.io/badge/Built_with-Nix-5277C3?logo=nixos&labelColor=fff)](https://builtwithnix.org)
![package version](https://img.shields.io/github/package-json/v/soopyc/2024-sba/main?label=package%20version)

School-Based Assessment for the 2024 HKDSE

The website is now live at https://2024.sba.mockups.soopy.moe/

## Build and deployment instructions

Practically the same as other svelte sites.

```bash
# Ensure Node.JS is installed and is at least v18.
$ node -v
# Ensure pnpm is installed
$ corepack enable pnpm
# Install project dependencies
$ pnpm install
# Run the development server
$ pnpm dev
```

You will need to setup some environment variables. An example .env file is provided
in ./.env.example

~~This site is written to permit static rendering. That means the site can be
served with most, if not any, static web servers. To generate the site, run:~~

Due to a new addition to the site (API `/preregister`), static generation is not
possible for all pages. This requires the usage of a node.js adapter.

```ShellSession
# To build, run
$ pnpm build
# To run the server, run
$ node build
```

The resulting directory can be found in `$PWD/build`.

## experimental Nix support

I'm currently adding experimental nix deployment support, which requires a number of hacks.
They deviate from the standard create-svelte layout, which are documented here for clarity's sake.

- we cannot write to `node_modules/*`, but vite uses `node_modules/.vite` for caching by default.
  while this is a non-issue while building, using the dev server requires the cache.
  - solution: create a new `.cache/` directory and reroute cacheDir in vite.config.ts to `.cache/vite`

### dev(s)hell

this project has [direnv](https://direnv.net) setup, which if you have it installed, should prompt you to approve the `.envrc`.

first, properly audit the direnv file and the related nix shell definitions. afterwards, simply run `direnv allow`
and you will get spammed with direnv logs.

## Credits

- Directory layout generated by [create-svelte](https://kit.svelte.dev/docs/creating-a-project)
- School Badge: adapted from Stewards Pooi Kei College for background removal.
- everyone who helped

## License

The source code is licensed under BSD 3-Clause License.

Used images and videos are licensed separately.

<!-- students against homophobia and transphobia! say no to any kind of bigotry. -->
